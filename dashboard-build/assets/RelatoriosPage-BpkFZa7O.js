import{j as e,A as ge,m as R}from"./motion-CnUDAaLS.js";import{r as Y}from"./react-vendor-DDxOQdDP.js";import{s as E,u as fe}from"./index-DNvzsDZk.js";import{u as Z}from"./useQuery-CJKtlTfW.js";import{u as je}from"./useAlertModal-Den3me5c.js";import{L as ve}from"./LoadingSpinner-QA4ydWnx.js";import{R as u,P as $,b as O,c as S,T as g,L as D,A as X,C as _,X as N,Y as w,a as T,B,d as F}from"./charts-BucqJsk_.js";import"./export-Dlusqx8k.js";import"./supabase-BCnEU3Yj.js";import"./analytics-BMD6QFpy.js";function ye(i,n={}){return Z({queryKey:["relatorios",i,n],enabled:!!i,queryFn:async()=>{const c=new Date,l=new Date;l.setDate(c.getDate()-parseInt(n.periodo||"30"));let x=E.from("leads").select(`
          id, nome, email, telefone, fonte, score, categoria,
          capital_disponivel, cidade, estado, urgencia,
          experiencia_anterior, resumo_qualificacao,
          created_at, updated_at,
          marca:id_marca (id, nome, emoji),
          operador:id_operador_responsavel (id, nome, role),
          status_comercial:id_status (id, label, slug),
          motivo_desistencia:id_motivo_desistencia (id, nome)
        `).eq("tenant_id",i).is("deleted_at",null).gte("created_at",l.toISOString()).order("created_at",{ascending:!1});n.marca&&n.marca!=="todas"&&(x=x.eq("id_marca",n.marca)),n.operador&&n.operador!=="todos"&&(x=x.eq("id_operador_responsavel",n.operador)),n.status&&n.status!=="todos"&&(x=x.eq("id_status",n.status));const{data:j,error:f}=await x;if(f)throw f;const h=j||[],p=s=>s.reduce((o,L)=>o+(parseFloat(L.capital_disponivel)||0),0),d=s=>h.filter(o=>(o.status_comercial?.slug||"").toLowerCase()===s),a=d("convertido"),b=d("perdido"),z=d("negociacao"),M=d("contato"),K=d("agendado"),t=d("novo"),r=h.length,v=[{etapa:"Novo Lead",count:t.length,capital:p(t),cor:"#6b7280"},{etapa:"Em Contato",count:M.length,capital:p(M),cor:"#3b82f6"},{etapa:"Agendado",count:K.length,capital:p(K),cor:"#f59e0b"},{etapa:"Em NegociaÃ§Ã£o",count:z.length,capital:p(z),cor:"#8b5cf6"},{etapa:"Convertido",count:a.length,capital:p(a),cor:"#10b981"},{etapa:"Perdido",count:b.length,capital:p(b),cor:"#ef4444"}],te=r>0?(a.length/r*100).toFixed(1):"0.0",ae=r>0?(b.length/r*100).toFixed(1):"0.0",se=a.length>0?(a.reduce((s,o)=>s+Math.ceil(Math.abs(new Date-new Date(o.created_at))/864e5),0)/a.length).toFixed(1):"0",oe=r>0?(h.reduce((s,o)=>s+(o.score||0),0)/r).toFixed(0):"0",re=p(h),ie=p(a),le=p(b),de=p(z),A={};h.forEach(s=>{const o=s.operador?.id||"sem_operador",L=s.operador?.nome||"NÃ£o atribuÃ­do";A[o]||(A[o]={nome:L,total:0,vendidos:0,perdidos:0,capital:0}),A[o].total++,A[o].capital+=parseFloat(s.capital_disponivel)||0,(s.status_comercial?.slug||"").toLowerCase()==="convertido"&&A[o].vendidos++,(s.status_comercial?.slug||"").toLowerCase()==="perdido"&&A[o].perdidos++});const ne=Object.values(A).map(s=>({...s,capital:s.capital,txConversao:s.total>0?(s.vendidos/s.total*100).toFixed(1):"0.0"})).sort((s,o)=>o.vendidos-s.vendidos),P={};h.forEach(s=>{const o=s.marca?.id||"sem_marca",L=s.marca?`${s.marca.emoji} ${s.marca.nome}`:"Sem Marca";P[o]||(P[o]={nome:L,total:0,vendidos:0,perdidos:0,capital:0}),P[o].total++,P[o].capital+=parseFloat(s.capital_disponivel)||0,(s.status_comercial?.slug||"").toLowerCase()==="convertido"&&P[o].vendidos++,(s.status_comercial?.slug||"").toLowerCase()==="perdido"&&P[o].perdidos++});const ce=Object.values(P).map(s=>({...s,txConversao:s.total>0?(s.vendidos/s.total*100).toFixed(1):"0.0"})).sort((s,o)=>o.total-s.total),I=parseInt(n.periodo||"30"),xe=Array.from({length:I},(s,o)=>{const L=new Date(c);L.setDate(c.getDate()-(I-1-o));const ue=L.toISOString().split("T")[0],H=h.filter(G=>G.created_at?.startsWith(ue)),U=H.filter(G=>(G.status_comercial?.slug||"").toLowerCase()==="convertido");return{dia:L.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"}),leads:H.length,vendidos:U.length,capital:p(U)}}),W={};h.forEach(s=>{const o=s.fonte||"NÃ£o informado";W[o]=(W[o]||0)+1});const he=Object.entries(W).map(([s,o])=>({name:s,value:o})).sort((s,o)=>o.value-s.value),q={};b.forEach(s=>{const o=s.motivo_desistencia?.nome||"NÃ£o informado";q[o]=(q[o]||0)+1});const pe=Object.entries(q).map(([s,o])=>({motivo:s.length>24?s.slice(0,24)+"â€¦":s,valor:o})).sort((s,o)=>o.valor-s.valor),V={};h.forEach(s=>{const o=s.estado||"NÃ£o informado";V[o]=(V[o]||0)+1});const me=Object.entries(V).map(([s,o])=>({name:s,value:o})).sort((s,o)=>o.value-s.value).slice(0,10),be=[{faixa:"0-20",count:h.filter(s=>(s.score||0)<=20).length},{faixa:"21-40",count:h.filter(s=>(s.score||0)>20&&(s.score||0)<=40).length},{faixa:"41-60",count:h.filter(s=>(s.score||0)>40&&(s.score||0)<=60).length},{faixa:"61-80",count:h.filter(s=>(s.score||0)>60&&(s.score||0)<=80).length},{faixa:"81-100",count:h.filter(s=>(s.score||0)>80).length}];return{total:r,txConversao:te,txPerda:ae,cicloMedio:se,scoreMedio:oe,capitalTotal:re,capitalConvertido:ie,capitalPerdido:le,capitalPipeline:de,vendidos:a.length,perdidos:b.length,funil:v,porConsultor:ne,porMarca:ce,temporal:xe,porFonte:he,motivosPerda:pe,porRegiao:me,scoreDist:be,leads:h}}})}function Ne(i){return Z({queryKey:["filtros-relatorio",i],enabled:!!i,queryFn:async()=>{const[n,c,l]=await Promise.all([E.from("marcas").select("id,nome,emoji").eq("tenant_id",i).eq("ativo",!0),E.from("usuarios").select("id,nome").eq("tenant_id",i).eq("active",!0),E.from("status_comercial").select("id,label,slug").eq("tenant_id",i)]);return{marcas:n.data||[],operadores:c.data||[],status:l.data||[]}}})}const k=["#10B981","#3b82f6","#3b82f6","#8b5cf6","#ec4899","#10b981","#f43f5e","#06b6d4"],y=i=>i>=1e6?`R$ ${(i/1e6).toFixed(1)}mi`:i>=1e3?`R$ ${(i/1e3).toFixed(0)}k`:`R$ ${Math.round(i)}`,we=i=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(i);function C({active:i,payload:n,label:c}){return!i||!n?.length?null:e.jsxs("div",{className:"bg-[#0F172A] border border-[#10B981]/20 rounded-xl px-4 py-3 shadow-xl text-xs",children:[e.jsx("p",{className:"text-gray-400 mb-1 font-bold",children:c}),n.map((l,x)=>e.jsxs("p",{style:{color:l.color},className:"font-bold",children:[l.name,": ",typeof l.value=="number"&&l.value>1e3?y(l.value):l.value]},x))]})}const J=[{id:"funil",icon:"ðŸ”½",label:"Funil de Vendas",desc:"Visualize cada etapa do pipeline",cor:"from-purple-500/20 to-purple-500/5",border:"border-purple-500/30"},{id:"conversao",icon:"ðŸŽ¯",label:"ConversÃ£o",desc:"Taxa de fechamento e performance",cor:"from-green-500/20 to-green-500/5",border:"border-green-500/30"},{id:"consultor",icon:"ðŸ‘¤",label:"Por Consultor",desc:"Ranking e performance do time",cor:"from-blue-500/20 to-blue-500/5",border:"border-blue-500/30"},{id:"marca",icon:"ðŸ¢",label:"Por Marca",desc:"Leads e conversÃµes por marca",cor:"from-orange-500/20 to-orange-500/5",border:"border-orange-500/30"},{id:"temporal",icon:"ðŸ“…",label:"AnÃ¡lise Temporal",desc:"EvoluÃ§Ã£o de leads ao longo do tempo",cor:"from-cyan-500/20 to-cyan-500/5",border:"border-cyan-500/30"},{id:"fonte",icon:"ðŸ“¡",label:"Por Fonte",desc:"De onde vÃªm seus melhores leads",cor:"from-pink-500/20 to-pink-500/5",border:"border-pink-500/30"},{id:"perda",icon:"ðŸ’”",label:"AnÃ¡lise de Perdas",desc:"Motivos e padrÃµes de desistÃªncia",cor:"from-red-500/20 to-red-500/5",border:"border-red-500/30"},{id:"regiao",icon:"ðŸ—ºï¸",label:"Por RegiÃ£o",desc:"DistribuiÃ§Ã£o geogrÃ¡fica dos leads",cor:"from-yellow-500/20 to-yellow-500/5",border:"border-yellow-500/30"},{id:"score",icon:"âš¡",label:"Score de Leads",desc:"DistribuiÃ§Ã£o de qualidade dos leads",cor:"from-indigo-500/20 to-indigo-500/5",border:"border-indigo-500/30"},{id:"capital",icon:"ðŸ’°",label:"AnÃ¡lise de Capital",desc:"Pipeline financeiro e oportunidades",cor:"from-emerald-500/20 to-emerald-500/5",border:"border-emerald-500/30"}],ee=[{label:"7 dias",value:"7"},{label:"15 dias",value:"15"},{label:"30 dias",value:"30"},{label:"60 dias",value:"60"},{label:"90 dias",value:"90"}];function m({label:i,value:n,sub:c,icon:l,cor:x}){return e.jsxs("div",{className:`bg-[#0F172A] border rounded-2xl p-5 flex flex-col gap-1.5 ${x||"border-white/5"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-[9px] font-black uppercase tracking-[0.2em] text-gray-500",children:i}),e.jsx("span",{className:"text-xl opacity-50",children:l})]}),e.jsx("p",{className:"text-2xl font-black text-white",children:n}),c&&e.jsx("p",{className:"text-[10px] text-gray-600",children:c})]})}function Q({dados:i,colunas:n}){return e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-white/5",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsx("tr",{className:"border-b border-white/5 bg-[#0B1220]",children:n.map((c,l)=>e.jsx("th",{className:"px-4 py-3 text-left text-[9px] font-black uppercase tracking-wider text-gray-500",children:c.label},l))})}),e.jsxs("tbody",{children:[i.map((c,l)=>e.jsx("tr",{className:`border-b border-white/5 hover:bg-white/3 transition-colors ${l===0?"bg-[#10B981]/5":""}`,children:n.map((x,j)=>e.jsx("td",{className:"px-4 py-3",children:x.render?x.render(c[x.key],c,l):e.jsx("span",{className:"text-gray-300 text-xs",children:c[x.key]})},j))},l)),i.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:n.length,className:"px-4 py-8 text-center text-gray-600 text-xs",children:"Sem dados no perÃ­odo"})})]})]})})}function ke(i,n,c){if(!i?.length){c&&c({type:"warning",title:"AtenÃ§Ã£o",message:"Sem dados para exportar."});return}const l=Object.keys(i[0]),x=i.map(h=>l.map(p=>{const d=h[p];return typeof d=="object"?JSON.stringify(d):String(d??"")})),j="\uFEFF"+[l.join(","),...x.map(h=>h.map(p=>`"${p}"`).join(","))].join(`
`),f=document.createElement("a");f.href=URL.createObjectURL(new Blob([j],{type:"text/csv;charset=utf-8;"})),f.download=`${n}_${new Date().toISOString().split("T")[0]}.csv`,f.click()}function Ce(){window.print()}function Le({tipoAtivo:i,tipoInfo:n,filtros:c,setFiltros:l,filtrosData:x,isLoading:j,d:f,onVoltar:h,onExportCSV:p}){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-4 lg:px-10 pt-6 lg:pt-8 mb-6 flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 print:hidden",children:[e.jsxs(R.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:[e.jsxs("h1",{className:"text-2xl lg:text-4xl font-light text-white mb-1",children:["Central de ",e.jsx("span",{className:"text-[#10B981] font-bold",children:"RelatÃ³rios"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 h-0.5 bg-[#10B981] rounded-full"}),e.jsx("p",{className:"text-[8px] lg:text-[9px] text-gray-600 font-black uppercase tracking-[0.3em]",children:"RelatÃ³rios EstratÃ©gicos e Operacionais"})]})]}),i&&e.jsxs(R.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"flex items-center gap-2 flex-wrap",children:[e.jsx("button",{onClick:p,className:"flex items-center gap-2 bg-[#0F172A] border border-white/10 hover:border-green-500/40 px-4 py-2.5 rounded-xl text-xs font-black text-gray-400 hover:text-green-400 transition-all",children:"ðŸ“Š CSV"}),e.jsx("button",{onClick:Ce,className:"flex items-center gap-2 bg-[#0F172A] border border-white/10 hover:border-red-500/40 px-4 py-2.5 rounded-xl text-xs font-black text-gray-400 hover:text-red-400 transition-all",children:"ðŸ“„ PDF"}),e.jsx("button",{onClick:h,className:"flex items-center gap-2 bg-[#10B981] hover:bg-[#059669] px-5 py-2.5 rounded-xl text-xs font-black text-black transition-all shadow-lg shadow-[#10B981]/20",children:"â† Voltar"})]})]}),e.jsx("div",{className:"px-4 lg:px-10 mb-8 print:hidden",children:e.jsxs("div",{className:"bg-[#0F172A] border border-white/5 rounded-2xl p-4 flex flex-wrap gap-3 items-center",children:[e.jsx("span",{className:"text-[9px] font-black uppercase tracking-wider text-gray-600",children:"Filtros:"}),e.jsx("select",{value:c.periodo,onChange:d=>l(a=>({...a,periodo:d.target.value})),className:"bg-[#0B1220] border border-white/10 rounded-xl px-3 py-2 text-xs font-bold text-white focus:outline-none focus:border-[#10B981]/50 cursor-pointer",children:ee.map(d=>e.jsx("option",{value:d.value,children:d.label},d.value))}),e.jsxs("select",{value:c.marca,onChange:d=>l(a=>({...a,marca:d.target.value})),className:"bg-[#0B1220] border border-white/10 rounded-xl px-3 py-2 text-xs font-bold text-white focus:outline-none focus:border-[#10B981]/50 cursor-pointer",children:[e.jsx("option",{value:"todas",children:"Todas as Marcas"}),(x?.marcas||[]).map(d=>e.jsxs("option",{value:d.id,children:[d.emoji," ",d.nome]},d.id))]}),e.jsxs("select",{value:c.operador,onChange:d=>l(a=>({...a,operador:d.target.value})),className:"bg-[#0B1220] border border-white/10 rounded-xl px-3 py-2 text-xs font-bold text-white focus:outline-none focus:border-[#10B981]/50 cursor-pointer",children:[e.jsx("option",{value:"todos",children:"Todos os Consultores"}),(x?.operadores||[]).map(d=>e.jsx("option",{value:d.id,children:d.nome},d.id))]}),j&&e.jsx("span",{className:"w-3 h-3 border-2 border-[#10B981] border-t-transparent rounded-full animate-spin inline-block"}),e.jsxs("div",{className:"ml-auto flex items-center gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-base font-black text-white",children:f.total||0}),e.jsx("p",{className:"text-[8px] text-gray-600 uppercase font-bold",children:"Leads"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-base font-black text-green-400",children:f.vendidos||0}),e.jsx("p",{className:"text-[8px] text-gray-600 uppercase font-bold",children:"Convertidos"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-base font-black text-[#10B981]",children:[f.txConversao||"0.0","%"]}),e.jsx("p",{className:"text-[8px] text-gray-600 uppercase font-bold",children:"TX Conv."})]})]})]})})]})}function Ke(){const{usuario:i}=fe(),{alertModal:n,showAlert:c}=je(),[l,x]=Y.useState(null),[j,f]=Y.useState({periodo:"30",marca:"todas",operador:"todos"}),{data:h}=Ne(i?.tenant_id),{data:p,isLoading:d}=ye(i?.tenant_id,j),a=p||{},b=J.find(t=>t.id===l),z=()=>x(null),M=()=>ke(a.leads||[],b?.label||"relatorio",c),K=()=>{switch(l){case"funil":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-4",children:(a.funil||[]).map((t,r)=>e.jsxs("div",{className:"bg-[#0F172A] border border-white/5 rounded-2xl p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-xs font-bold text-gray-400",children:t.etapa}),e.jsx("span",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:t.cor}})]}),e.jsx("p",{className:"text-3xl font-black text-white",children:t.count}),e.jsxs("p",{className:"text-[10px] text-gray-600 mt-1",children:[y(t.capital)," em capital"]}),e.jsx("div",{className:"mt-3 h-1.5 bg-white/5 rounded-full overflow-hidden",children:e.jsx(R.div,{initial:{width:0},animate:{width:`${a.total>0?(t.count/a.total*100).toFixed(0):0}%`},transition:{duration:.8,delay:r*.1},className:"h-full rounded-full",style:{backgroundColor:t.cor}})}),e.jsxs("p",{className:"text-[9px] text-gray-600 mt-1",children:[a.total>0?(t.count/a.total*100).toFixed(1):0,"% do total"]})]},r))}),e.jsxs("div",{className:"bg-[#0F172A] border border-white/5 rounded-2xl p-6",children:[e.jsx("h4",{className:"text-sm font-bold text-white mb-4",children:"DistribuiÃ§Ã£o Visual do Funil"}),e.jsx("div",{className:"h-[280px]",children:e.jsx(u,{width:"100%",height:"100%",minWidth:0,children:e.jsxs(B,{data:a.funil||[],margin:{top:5,right:5,bottom:5,left:-10},children:[e.jsx(_,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.03)"}),e.jsx(N,{dataKey:"etapa",stroke:"#374151",fontSize:9,axisLine:!1,tickLine:!1}),e.jsx(w,{stroke:"#374151",fontSize:9,axisLine:!1,tickLine:!1}),e.jsx(g,{content:e.jsx(C,{})}),e.jsx(F,{dataKey:"count",name:"Leads",radius:[8,8,0,0],barSize:44,children:(a.funil||[]).map((t,r)=>e.jsx(S,{fill:t.cor},r))})]})})})]})]});case"conversao":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(m,{label:"Taxa ConversÃ£o",value:`${a.txConversao||0}%`,icon:"ðŸŽ¯",sub:"Meta: 20%",cor:"border-green-500/20"}),e.jsx(m,{label:"Taxa Perda",value:`${a.txPerda||0}%`,icon:"ðŸ’”",sub:`${a.perdidos||0} perdidos`,cor:"border-red-500/20"}),e.jsx(m,{label:"Ciclo MÃ©dio",value:`${a.cicloMedio||0}d`,icon:"â±ï¸",sub:"AtÃ© conversÃ£o"}),e.jsx(m,{label:"Score MÃ©dio",value:a.scoreMedio||0,icon:"âš¡",sub:"De 0 a 100"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-[#0F172A] border border-white/5 rounded-2xl p-6",children:[e.jsx("h4",{className:"text-sm font-bold text-white mb-4",children:"EvoluÃ§Ã£o de ConversÃµes"}),e.jsx("div",{className:"h-[240px]",children:e.jsx(u,{width:"100%",height:"100%",minWidth:0,children:e.jsxs(X,{data:a.temporal||[],margin:{top:5,right:5,bottom:5,left:-20},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"gVc",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:0})]})}),e.jsx(_,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.03)"}),e.jsx(N,{dataKey:"dia",stroke:"#374151",fontSize:9,axisLine:!1,tickLine:!1}),e.jsx(w,{stroke:"#374151",fontSize:9,axisLine:!1,tickLine:!1}),e.jsx(g,{content:e.jsx(C,{})}),e.jsx(T,{type:"monotone",dataKey:"vendidos",name:"Convertidos",stroke:"#10b981",fill:"url(#gVc)",strokeWidth:2.5,dot:!1})]})})})]}),e.jsxs("div",{className:"bg-[#0F172A] border border-white/5 rounded-2xl p-6",children:[e.jsx("h4",{className:"text-sm font-bold text-white mb-4",children:"DistribuiÃ§Ã£o de Status"}),e.jsx("div",{className:"h-[240px]",children:e.jsx(u,{width:"100%",height:"100%",minWidth:0,children:e.jsxs($,{children:[e.jsx(O,{data:(a.funil||[]).filter(t=>t.count>0),innerRadius:50,outerRadius:80,paddingAngle:3,dataKey:"count",nameKey:"etapa",stroke:"none",children:(a.funil||[]).filter(t=>t.count>0).map((t,r)=>e.jsx(S,{fill:t.cor},r))}),e.jsx(g,{contentStyle:{backgroundColor:"#0B1220",border:"1px solid rgba(16,185,129,0.2)",borderRadius:"12px"}}),e.jsx(D,{verticalAlign:"bottom",height:36,formatter:t=>e.jsx("span",{style:{color:"#6a6a6f",fontSize:"10px"},children:t})})]})})})]})]})]});case"consultor":return e.jsxs("div",{className:"space-y-6",children:[e.jsx(Q,{dados:a.porConsultor||[],colunas:[{key:"_rank",label:"#",render:(t,r,v)=>e.jsx("span",{className:`text-sm font-black ${v===0?"text-[#10B981]":v===1?"text-gray-300":v===2?"text-yellow-600":"text-gray-600"}`,children:v===0?"ðŸ¥‡":v===1?"ðŸ¥ˆ":v===2?"ðŸ¥‰":`${v+1}Âº`})},{key:"nome",label:"Consultor",render:t=>e.jsx("span",{className:"text-white font-bold text-xs",children:t})},{key:"total",label:"Leads",render:t=>e.jsx("span",{className:"text-gray-300 text-xs font-bold",children:t})},{key:"vendidos",label:"Convertidos",render:t=>e.jsx("span",{className:"text-green-400 text-xs font-bold",children:t})},{key:"perdidos",label:"Perdidos",render:t=>e.jsx("span",{className:"text-red-400 text-xs font-bold",children:t})},{key:"txConversao",label:"ConversÃ£o",render:t=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-16 bg-white/5 rounded-full h-1.5 overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-400 rounded-full",style:{width:`${Math.min(100,parseFloat(t))}%`}})}),e.jsxs("span",{className:"text-green-400 text-xs font-bold",children:[t,"%"]})]})},{key:"capital",label:"Capital",render:t=>e.jsx("span",{className:"text-[#10B981] text-xs font-bold",children:y(t)})}]}),e.jsxs("div",{className:"bg-[#0F172A] border border-white/5 rounded-2xl p-6",children:[e.jsx("h4",{className:"text-sm font-bold text-white mb-4",children:"Comparativo de Performance"}),e.jsx("div",{className:"h-[260px]",children:e.jsx(u,{width:"100%",height:"100%",minWidth:0,children:e.jsxs(B,{data:a.porConsultor||[],margin:{top:5,right:5,bottom:20,left:-10},children:[e.jsx(_,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.03)"}),e.jsx(N,{dataKey:"nome",stroke:"#374151",fontSize:8,axisLine:!1,tickLine:!1,angle:-15,textAnchor:"end"}),e.jsx(w,{stroke:"#374151",fontSize:9,axisLine:!1,tickLine:!1}),e.jsx(g,{content:e.jsx(C,{})}),e.jsx(F,{dataKey:"total",name:"Total",fill:"#3b82f6",radius:[4,4,0,0],barSize:16}),e.jsx(F,{dataKey:"vendidos",name:"Convertidos",fill:"#10b981",radius:[4,4,0,0],barSize:16}),e.jsx(F,{dataKey:"perdidos",name:"Perdidos",fill:"#ef4444",radius:[4,4,0,0],barSize:16}),e.jsx(D,{verticalAlign:"top",height:28,formatter:t=>e.jsx("span",{style:{color:"#9ca3af",fontSize:"10px"},children:t})})]})})})]})]});case"marca":return e.jsxs("div",{className:"space-y-6",children:[e.jsx(Q,{dados:a.porMarca||[],colunas:[{key:"_rank",label:"#",render:(t,r,v)=>e.jsxs("span",{className:"text-gray-600 text-xs font-black",children:[v+1,"Âº"]})},{key:"nome",label:"Marca",render:t=>e.jsx("span",{className:"text-white font-bold text-xs",children:t})},{key:"total",label:"Leads",render:t=>e.jsx("span",{className:"text-gray-300 text-xs font-bold",children:t})},{key:"vendidos",label:"Convertidos",render:t=>e.jsx("span",{className:"text-green-400 text-xs font-bold",children:t})},{key:"txConversao",label:"TX Conv.",render:t=>e.jsxs("span",{className:"text-[#10B981] text-xs font-bold",children:[t,"%"]})},{key:"capital",label:"Capital",render:t=>e.jsx("span",{className:"text-[#10B981] text-xs font-bold",children:y(t)})}]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-[#0F172A] border border-white/5 rounded-2xl p-6",children:[e.jsx("h4",{className:"text-sm font-bold text-white mb-4",children:"Leads por Marca"}),e.jsx("div",{className:"h-[240px]",children:e.jsx(u,{width:"100%",height:"100%",minWidth:0,children:e.jsxs($,{children:[e.jsx(O,{data:a.porMarca||[],innerRadius:50,outerRadius:80,paddingAngle:3,dataKey:"total",nameKey:"nome",stroke:"none",children:(a.porMarca||[]).map((t,r)=>e.jsx(S,{fill:k[r%k.length]},r))}),e.jsx(g,{contentStyle:{backgroundColor:"#0B1220",border:"1px solid rgba(16,185,129,0.2)",borderRadius:"12px"}}),e.jsx(D,{verticalAlign:"bottom",height:36,formatter:t=>e.jsx("span",{style:{color:"#6a6a6f",fontSize:"10px"},children:t})})]})})})]}),e.jsxs("div",{className:"bg-[#0F172A] border border-white/5 rounded-2xl p-6",children:[e.jsx("h4",{className:"text-sm font-bold text-white mb-4",children:"ConversÃ£o por Marca"}),e.jsx("div",{className:"h-[240px]",children:e.jsx(u,{width:"100%",height:"100%",minWidth:0,children:e.jsxs(B,{data:a.porMarca||[],layout:"vertical",margin:{top:5,right:20,bottom:5,left:5},children:[e.jsx(N,{type:"number",stroke:"#374151",fontSize:9,axisLine:!1,tickLine:!1}),e.jsx(w,{type:"category",dataKey:"nome",stroke:"#374151",fontSize:9,axisLine:!1,tickLine:!1,width:100}),e.jsx(g,{content:e.jsx(C,{})}),e.jsx(F,{dataKey:"vendidos",name:"Convertidos",fill:"#10b981",radius:[0,8,8,0],barSize:20})]})})})]})]})]});case"temporal":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-[#0F172A] border border-white/5 rounded-2xl p-6",children:[e.jsx("h4",{className:"text-sm font-bold text-white mb-4",children:"EvoluÃ§Ã£o de Leads no PerÃ­odo"}),e.jsx("div",{className:"h-[300px]",children:e.jsx(u,{width:"100%",height:"100%",minWidth:0,children:e.jsxs(X,{data:a.temporal||[],margin:{top:5,right:5,bottom:5,left:-10},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"gLt",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10B981",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#10B981",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"gVt",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.2}),e.jsx("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:0})]})]}),e.jsx(_,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.03)"}),e.jsx(N,{dataKey:"dia",stroke:"#374151",fontSize:9,axisLine:!1,tickLine:!1}),e.jsx(w,{stroke:"#374151",fontSize:9,axisLine:!1,tickLine:!1}),e.jsx(g,{content:e.jsx(C,{})}),e.jsx(T,{type:"monotone",dataKey:"leads",name:"Leads",stroke:"#10B981",fill:"url(#gLt)",strokeWidth:2.5,dot:!1}),e.jsx(T,{type:"monotone",dataKey:"vendidos",name:"Convertidos",stroke:"#10b981",fill:"url(#gVt)",strokeWidth:2,dot:!1,strokeDasharray:"5 3"}),e.jsx(D,{verticalAlign:"top",height:28,formatter:t=>e.jsx("span",{style:{color:"#9ca3af",fontSize:"10px"},children:t})})]})})})]}),e.jsxs("div",{className:"bg-[#0F172A] border border-white/5 rounded-2xl p-6",children:[e.jsx("h4",{className:"text-sm font-bold text-white mb-4",children:"Capital Convertido por Dia"}),e.jsx("div",{className:"h-[220px]",children:e.jsx(u,{width:"100%",height:"100%",minWidth:0,children:e.jsxs(B,{data:a.temporal||[],margin:{top:5,right:5,bottom:5,left:10},children:[e.jsx(_,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.03)"}),e.jsx(N,{dataKey:"dia",stroke:"#374151",fontSize:9,axisLine:!1,tickLine:!1}),e.jsx(w,{stroke:"#374151",fontSize:9,axisLine:!1,tickLine:!1,tickFormatter:t=>y(t)}),e.jsx(g,{content:e.jsx(C,{})}),e.jsx(F,{dataKey:"capital",name:"Capital",fill:"#10B981",radius:[6,6,0,0],barSize:16})]})})})]})]});case"fonte":return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-[#0F172A] border border-white/5 rounded-2xl p-6",children:[e.jsx("h4",{className:"text-sm font-bold text-white mb-4",children:"Leads por Fonte"}),e.jsx("div",{className:"h-[280px]",children:e.jsx(u,{width:"100%",height:"100%",minWidth:0,children:e.jsxs($,{children:[e.jsx(O,{data:a.porFonte||[],innerRadius:55,outerRadius:85,paddingAngle:4,dataKey:"value",nameKey:"name",stroke:"none",children:(a.porFonte||[]).map((t,r)=>e.jsx(S,{fill:k[r%k.length]},r))}),e.jsx(g,{contentStyle:{backgroundColor:"#0B1220",border:"1px solid rgba(16,185,129,0.2)",borderRadius:"12px"}}),e.jsx(D,{verticalAlign:"bottom",height:36,formatter:t=>e.jsx("span",{style:{color:"#6a6a6f",fontSize:"10px"},children:t})})]})})})]}),e.jsx("div",{className:"space-y-3",children:(a.porFonte||[]).map((t,r)=>e.jsxs("div",{className:"bg-[#0F172A] border border-white/5 rounded-xl px-4 py-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[e.jsx("span",{className:"text-xs font-bold text-white",children:t.name}),e.jsxs("span",{className:"text-xs font-black text-[#10B981]",children:[t.value," leads"]})]}),e.jsx("div",{className:"h-1.5 bg-white/5 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${a.total>0?(t.value/a.total*100).toFixed(0):0}%`,backgroundColor:k[r%k.length]}})}),e.jsxs("p",{className:"text-[9px] text-gray-600 mt-1",children:[a.total>0?(t.value/a.total*100).toFixed(1):0,"% do total"]})]},r))})]})});case"perda":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(m,{label:"Total Perdidos",value:a.perdidos||0,icon:"ðŸ’”",sub:`${a.txPerda||0}% do total`,cor:"border-red-500/20"}),e.jsx(m,{label:"Capital Perdido",value:y(a.capitalPerdido||0),icon:"ðŸ’¸",sub:"Oportunidades perdidas",cor:"border-red-500/20"}),e.jsx(m,{label:"Ciclo atÃ© Perda",value:`${a.cicloMedio||0}d`,icon:"â±ï¸",sub:"MÃ©dia atÃ© desistir",cor:"border-orange-500/20"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-[#0F172A] border border-white/5 rounded-2xl p-6",children:[e.jsx("h4",{className:"text-sm font-bold text-white mb-4",children:"Principais Motivos de Perda"}),e.jsx("div",{className:"h-[260px]",children:e.jsx(u,{width:"100%",height:"100%",minWidth:0,children:e.jsxs(B,{data:a.motivosPerda||[],margin:{top:5,right:5,bottom:25,left:-10},children:[e.jsx(_,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.03)"}),e.jsx(N,{dataKey:"motivo",stroke:"#374151",fontSize:8,axisLine:!1,tickLine:!1,angle:-20,textAnchor:"end"}),e.jsx(w,{stroke:"#374151",fontSize:9,axisLine:!1,tickLine:!1}),e.jsx(g,{content:e.jsx(C,{})}),e.jsx(F,{dataKey:"valor",name:"Leads",fill:"#ef4444",radius:[8,8,0,0],barSize:32})]})})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-bold text-white",children:"Ranking de Motivos"}),(a.motivosPerda||[]).map((t,r)=>e.jsxs("div",{className:"bg-[#0F172A] border border-white/5 rounded-xl px-4 py-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[e.jsx("span",{className:"text-xs font-bold text-white",children:t.motivo}),e.jsxs("span",{className:"text-xs font-black text-red-400",children:[t.valor,"x"]})]}),e.jsx("div",{className:"h-1.5 bg-white/5 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-red-500 rounded-full",style:{width:`${a.perdidos>0?(t.valor/a.perdidos*100).toFixed(0):0}%`}})})]},r)),!(a.motivosPerda||[]).length&&e.jsx("p",{className:"text-xs text-gray-600 text-center py-8",children:"Nenhuma perda registrada ðŸŽ‰"})]})]})]});case"regiao":return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-[#0F172A] border border-white/5 rounded-2xl p-6",children:[e.jsx("h4",{className:"text-sm font-bold text-white mb-4",children:"Leads por Estado"}),e.jsx("div",{className:"h-[280px]",children:e.jsx(u,{width:"100%",height:"100%",minWidth:0,children:e.jsxs(B,{data:a.porRegiao||[],layout:"vertical",margin:{top:5,right:20,bottom:5,left:10},children:[e.jsx(N,{type:"number",stroke:"#374151",fontSize:9,axisLine:!1,tickLine:!1}),e.jsx(w,{type:"category",dataKey:"name",stroke:"#374151",fontSize:9,axisLine:!1,tickLine:!1,width:40}),e.jsx(g,{content:e.jsx(C,{})}),e.jsx(F,{dataKey:"value",name:"Leads",radius:[0,8,8,0],barSize:18,children:(a.porRegiao||[]).map((t,r)=>e.jsx(S,{fill:k[r%k.length]},r))})]})})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-bold text-white mb-3",children:"Top Estados"}),(a.porRegiao||[]).map((t,r)=>e.jsxs("div",{className:"flex items-center gap-3 bg-[#0F172A] border border-white/5 rounded-xl px-4 py-2.5",children:[e.jsx("span",{className:"text-base font-black text-gray-600 w-6 text-center",children:r+1}),e.jsx("span",{className:"flex-1 text-xs font-bold text-white",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-20 bg-white/5 rounded-full h-1.5 overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${a.total>0?(t.value/a.total*100).toFixed(0):0}%`,backgroundColor:k[r%k.length]}})}),e.jsx("span",{className:"text-xs font-black text-[#10B981] w-8 text-right",children:t.value})]})]},r))]})]})});case"score":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(m,{label:"Score MÃ©dio",value:a.scoreMedio||0,icon:"âš¡",sub:"De 0 a 100"}),e.jsx(m,{label:"Total Leads",value:a.total||0,icon:"ðŸŽ¯"}),e.jsx(m,{label:"Convertidos",value:a.vendidos||0,icon:"âœ…",cor:"border-green-500/20"}),e.jsx(m,{label:"TX ConversÃ£o",value:`${a.txConversao||0}%`,icon:"ðŸ“ˆ",cor:"border-[#10B981]/20"})]}),e.jsxs("div",{className:"bg-[#0F172A] border border-white/5 rounded-2xl p-6",children:[e.jsx("h4",{className:"text-sm font-bold text-white mb-4",children:"DistribuiÃ§Ã£o de Score"}),e.jsx("div",{className:"h-[260px]",children:e.jsx(u,{width:"100%",height:"100%",minWidth:0,children:e.jsxs(B,{data:a.scoreDist||[],margin:{top:5,right:5,bottom:5,left:-10},children:[e.jsx(_,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.03)"}),e.jsx(N,{dataKey:"faixa",stroke:"#374151",fontSize:10,axisLine:!1,tickLine:!1}),e.jsx(w,{stroke:"#374151",fontSize:9,axisLine:!1,tickLine:!1}),e.jsx(g,{content:e.jsx(C,{})}),e.jsx(F,{dataKey:"count",name:"Leads",radius:[8,8,0,0],barSize:44,children:(a.scoreDist||[]).map((t,r)=>e.jsx(S,{fill:["#3b82f6","#f59e0b","#10B981","#ef4444","#dc2626"][r]},r))})]})})})]})]});case"capital":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(m,{label:"Capital Total",value:y(a.capitalTotal||0),icon:"ðŸ’°",sub:"Todos os leads",cor:"border-[#10B981]/20"}),e.jsx(m,{label:"Capital Convertido",value:y(a.capitalConvertido||0),icon:"âœ…",sub:`${a.vendidos||0} conversÃµes`,cor:"border-green-500/20"}),e.jsx(m,{label:"Capital Pipeline",value:y(a.capitalPipeline||0),icon:"ðŸ¤",sub:"Em negociaÃ§Ã£o",cor:"border-blue-500/20"}),e.jsx(m,{label:"Capital Perdido",value:y(a.capitalPerdido||0),icon:"ðŸ’”",sub:`${a.perdidos||0} perdidos`,cor:"border-red-500/20"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-[#0F172A] border border-white/5 rounded-2xl p-6",children:[e.jsx("h4",{className:"text-sm font-bold text-white mb-4",children:"DistribuiÃ§Ã£o de Capital"}),e.jsx("div",{className:"h-[260px]",children:e.jsx(u,{width:"100%",height:"100%",minWidth:0,children:e.jsxs($,{children:[e.jsxs(O,{data:[{name:"Convertido",value:a.capitalConvertido||0},{name:"Pipeline",value:a.capitalPipeline||0},{name:"Perdido",value:a.capitalPerdido||0}].filter(t=>t.value>0),innerRadius:60,outerRadius:90,paddingAngle:4,dataKey:"value",stroke:"none",children:[e.jsx(S,{fill:"#10b981"}),e.jsx(S,{fill:"#3b82f6"}),e.jsx(S,{fill:"#ef4444"})]}),e.jsx(g,{contentStyle:{backgroundColor:"#0B1220",border:"1px solid rgba(16,185,129,0.2)",borderRadius:"12px"},formatter:t=>we(t)}),e.jsx(D,{verticalAlign:"bottom",height:36,formatter:t=>e.jsx("span",{style:{color:"#6a6a6f",fontSize:"11px"},children:t})})]})})})]}),e.jsxs("div",{className:"bg-[#0F172A] border border-white/5 rounded-2xl p-6",children:[e.jsx("h4",{className:"text-sm font-bold text-white mb-4",children:"Capital DiÃ¡rio"}),e.jsx("div",{className:"h-[260px]",children:e.jsx(u,{width:"100%",height:"100%",minWidth:0,children:e.jsxs(X,{data:a.temporal||[],margin:{top:5,right:5,bottom:5,left:10},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"gCap",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10B981",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#10B981",stopOpacity:0})]})}),e.jsx(_,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.03)"}),e.jsx(N,{dataKey:"dia",stroke:"#374151",fontSize:9,axisLine:!1,tickLine:!1}),e.jsx(w,{stroke:"#374151",fontSize:9,axisLine:!1,tickLine:!1,tickFormatter:t=>y(t)}),e.jsx(g,{content:e.jsx(C,{})}),e.jsx(T,{type:"monotone",dataKey:"capital",name:"Capital",stroke:"#10B981",fill:"url(#gCap)",strokeWidth:2.5,dot:!1})]})})})]})]})]});default:return null}};return e.jsxs("div",{className:"min-h-screen bg-[#0B1220] text-white pb-32 print:bg-white print:text-black",children:[e.jsx(Le,{tipoAtivo:l,tipoInfo:b,filtros:j,setFiltros:f,filtrosData:h,isLoading:d,d:a,onVoltar:z,onExportCSV:M}),e.jsxs(ge,{mode:"wait",children:[!l&&e.jsxs(R.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"px-4 lg:px-10",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-bold text-white mb-1",children:"Selecione o RelatÃ³rio"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Escolha o tipo de anÃ¡lise que deseja visualizar"})]}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4",children:J.map((t,r)=>e.jsxs(R.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.05},whileHover:{scale:1.03,y:-3},whileTap:{scale:.97},onClick:()=>x(t.id),className:`relative bg-gradient-to-br ${t.cor} border ${t.border} rounded-2xl p-5 text-left hover:shadow-xl transition-all group overflow-hidden`,children:[e.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 rounded-full bg-white/3 -translate-y-4 translate-x-4 group-hover:scale-150 transition-transform duration-500"}),e.jsx("span",{className:"text-3xl mb-3 block",children:t.icon}),e.jsx("p",{className:"text-sm font-black text-white mb-1",children:t.label}),e.jsx("p",{className:"text-[9px] text-gray-500 leading-tight",children:t.desc})]},t.id))})]},"selecao"),l&&e.jsxs(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"px-4 lg:px-10",children:[e.jsxs("div",{className:`bg-gradient-to-r ${b?.cor} border ${b?.border} rounded-2xl p-5 mb-6 flex items-center gap-4`,children:[e.jsx("span",{className:"text-4xl",children:b?.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-black text-white",children:b?.label}),e.jsxs("p",{className:"text-xs text-gray-400",children:[b?.desc," Â· ",ee.find(t=>t.value===j.periodo)?.label]})]}),e.jsxs("div",{className:"text-right hidden lg:block",children:[e.jsx("p",{className:"text-[9px] text-gray-600 uppercase tracking-wider",children:"Gerado em"}),e.jsx("p",{className:"text-xs font-bold text-gray-400",children:new Date().toLocaleString("pt-BR")})]})]}),d?e.jsx(ve,{fullScreen:!1}):K()]},l)]}),n]})}export{Ke as default};
