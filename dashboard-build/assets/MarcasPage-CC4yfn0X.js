import{j as e,m as y}from"./motion-CnUDAaLS.js";import{r as i}from"./react-vendor-DDxOQdDP.js";import{u as q,s as w}from"./index-DNvzsDZk.js";import{F as D}from"./FAB-0kAuwrai.js";import{u as G}from"./useAlertModal-Den3me5c.js";import{L as H}from"./LoadingSpinner-QA4ydWnx.js";import"./export-Dlusqx8k.js";import"./supabase-BCnEU3Yj.js";import"./analytics-BMD6QFpy.js";function V({marca:t,index:u,onClick:c}){const x=t.leads?.length||0,m=h=>h?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(h):"N/A";return e.jsxs(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:u*.05},whileHover:{scale:1.02,y:-4},onClick:c,className:`
        bg-[#0F172A]
        border border-white/5
        rounded-3xl
        p-6 lg:p-8
        cursor-pointer
        transition-all
        hover:border-[#10B981]/30
        hover:shadow-xl
        hover:shadow-[#10B981]/10
        relative
        overflow-hidden
      `,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[#10B981]/5 to-transparent opacity-0 hover:opacity-100 transition-opacity pointer-events-none"}),e.jsxs("div",{className:"flex items-start justify-between mb-6 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[t.emoji&&e.jsx("div",{className:"text-4xl lg:text-5xl",children:t.emoji}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-xl lg:text-2xl font-bold text-white mb-1",children:t.nome}),e.jsxs("p",{className:"text-xs text-gray-600 font-mono truncate",children:["ID: ",t.id.substring(0,8),"..."]})]})]}),e.jsxs("div",{className:`
          bg-[#10B981]/10
          border border-[#10B981]/30
          rounded-xl
          px-3 py-1.5
          flex items-center gap-2
          flex-shrink-0
          ml-2
        `,children:[e.jsx("span",{className:"text-lg",children:"ðŸ‘¥"}),e.jsx("span",{className:"text-sm lg:text-base font-black text-[#10B981]",children:x})]})]}),(t.invest_min||t.invest_max)&&e.jsx("div",{className:"mb-6 relative z-10",children:e.jsxs("div",{className:"bg-white/5 rounded-xl p-4 border border-white/5",children:[e.jsx("div",{className:"text-xs text-gray-500 font-semibold mb-2",children:"ðŸ’° Faixa de Investimento"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"De"}),e.jsx("span",{className:"text-white font-bold",children:m(t.invest_min)}),e.jsx("span",{className:"text-gray-400",children:"atÃ©"}),e.jsx("span",{className:"text-[#10B981] font-bold",children:m(t.invest_max)})]})]})}),t.segmentos&&e.jsx("div",{className:"mb-6 relative z-10",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500 font-semibold",children:"Segmento:"}),e.jsxs("div",{className:`
              bg-white/5
              border border-white/10
              rounded-lg
              px-3 py-1
              text-sm
              text-white
              font-semibold
              flex items-center gap-2
            `,children:[t.segmentos.emoji&&e.jsx("span",{children:t.segmentos.emoji}),t.segmentos.nome]})]})}),t.ativo!==void 0&&e.jsx("div",{className:"mb-6 relative z-10",children:e.jsxs("div",{className:`
            inline-flex items-center gap-2
            px-3 py-1.5
            rounded-lg
            text-xs
            font-bold
            ${t.ativo?"bg-green-500/10 border border-green-500/30 text-green-500":"bg-red-500/10 border border-red-500/30 text-red-500"}
          `,children:[e.jsx("span",{children:t.ativo?"ðŸŸ¢":"ðŸ”´"}),e.jsx("span",{children:t.ativo?"ATIVA":"INATIVA"})]})}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-white/5 relative z-10",children:[e.jsxs("span",{className:"text-xs text-gray-600 font-semibold",children:["Criada em ",new Date(t.created_at).toLocaleDateString("pt-BR")]}),e.jsx(y.button,{whileHover:{x:4},className:"text-[#10B981] text-sm font-bold flex items-center gap-1",children:"Editar â†’"})]})]})}const Z=["ðŸ¢","ðŸ§º","â˜•","ðŸ”","ðŸ“š","ðŸ¥","ðŸ‹ï¸","ðŸ’¼","ðŸª","ðŸŽ“","ðŸš—","ðŸ’‡","ðŸ ","ðŸ•"],J=["#60a5fa","#f472b6","#a78bfa","#34d399","#fbbf24","#ef4444","#06b6d4","#84cc16"];function W({marca:t,segmentos:u,onClose:c,onSave:x,isSaving:m}){const[h,j]=i.useState(""),[n,o]=i.useState({nome:"",emoji:"ðŸ¢",cor:"#60a5fa",segmento_id:"",investimento_minimo:"",investimento_maximo:"",descricao:""});i.useEffect(()=>{t&&o({nome:t.nome||"",emoji:t.emoji||"ðŸ¢",cor:t.cor||"#60a5fa",segmento_id:t.segmento_id||"",investimento_minimo:t.investimento_minimo?.toString()||"",investimento_maximo:t.investimento_maximo?.toString()||"",descricao:t.descricao||""})},[t]);const b=()=>{if(!n.nome.trim()){j("O nome da marca Ã© obrigatÃ³rio.");return}j(""),x({...t?.id&&{id:t.id},nome:n.nome.trim(),emoji:n.emoji,cor:n.cor,segmento_id:n.segmento_id||null,investimento_minimo:parseFloat(n.investimento_minimo)||0,investimento_maximo:parseFloat(n.investimento_maximo)||0,descricao:n.descricao.trim()})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50",onClick:c}),e.jsx("div",{className:"fixed inset-0 z-50 flex items-end lg:items-center lg:justify-center p-0 lg:p-4",children:e.jsxs("div",{className:"bg-[#0F172A] border-t lg:border border-[#1F2937] rounded-t-3xl lg:rounded-2xl w-full lg:max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"flex-shrink-0 p-6 border-b border-[#1F2937]",children:[e.jsx("div",{className:"w-12 h-1 bg-[#1E293B] rounded-full mx-auto mb-4 lg:hidden"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:t?"Editar Marca":"Nova Marca"}),e.jsx("button",{onClick:c,className:"w-10 h-10 rounded-xl bg-[#1F2937] border border-[#1E293B] flex items-center justify-center text-[#6a6a6f] hover:text-white",children:"âœ•"})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] text-[#4a4a4f] uppercase tracking-wider mb-2",children:"Nome *"}),e.jsx("input",{type:"text",value:n.nome,onChange:a=>o({...n,nome:a.target.value}),placeholder:"Ex: Premium Wash",className:"w-full bg-[#1F2937] border border-[#1E293B] rounded-xl px-4 py-3 text-white placeholder:text-[#4a4a4f] focus:outline-none focus:border-[#10B981]/50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] text-[#4a4a4f] uppercase tracking-wider mb-2",children:"Segmento"}),e.jsxs("select",{value:n.segmento_id,onChange:a=>o({...n,segmento_id:a.target.value}),className:"w-full bg-[#1F2937] border border-[#1E293B] rounded-xl px-4 py-3 text-white focus:outline-none focus:border-[#10B981]/50",children:[e.jsx("option",{value:"",children:"Selecione um segmento"}),u.map(a=>e.jsxs("option",{value:a.id,children:[a.emoji," ",a.nome]},a.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] text-[#4a4a4f] uppercase tracking-wider mb-2",children:"Emoji"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Z.map(a=>e.jsx("button",{type:"button",onClick:()=>o({...n,emoji:a}),className:`w-10 h-10 rounded-lg flex items-center justify-center text-xl transition-all ${n.emoji===a?"bg-[#10B981]/20 border-2 border-[#10B981] scale-110":"bg-[#1F2937] border border-[#1E293B]"}`,children:a},a))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] text-[#4a4a4f] uppercase tracking-wider mb-2",children:"Cor"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:J.map(a=>e.jsx("button",{type:"button",onClick:()=>o({...n,cor:a}),className:`w-10 h-10 rounded-lg transition-all ${n.cor===a?"ring-2 ring-white scale-110":""}`,style:{backgroundColor:a}},a))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] text-[#4a4a4f] uppercase tracking-wider mb-2",children:"Invest. MÃ­nimo"}),e.jsx("input",{type:"number",value:n.investimento_minimo,onChange:a=>o({...n,investimento_minimo:a.target.value}),placeholder:"100000",className:"w-full bg-[#1F2937] border border-[#1E293B] rounded-xl px-4 py-3 text-white placeholder:text-[#4a4a4f] focus:outline-none focus:border-[#10B981]/50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] text-[#4a4a4f] uppercase tracking-wider mb-2",children:"Invest. MÃ¡ximo"}),e.jsx("input",{type:"number",value:n.investimento_maximo,onChange:a=>o({...n,investimento_maximo:a.target.value}),placeholder:"200000",className:"w-full bg-[#1F2937] border border-[#1E293B] rounded-xl px-4 py-3 text-white placeholder:text-[#4a4a4f] focus:outline-none focus:border-[#10B981]/50"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] text-[#4a4a4f] uppercase tracking-wider mb-2",children:"DescriÃ§Ã£o"}),e.jsx("textarea",{value:n.descricao,onChange:a=>o({...n,descricao:a.target.value}),placeholder:"Descreva a marca...",rows:3,className:"w-full bg-[#1F2937] border border-[#1E293B] rounded-xl px-4 py-3 text-white placeholder:text-[#4a4a4f] focus:outline-none focus:border-[#10B981]/50 resize-none"})]})]}),h&&e.jsx("div",{className:"px-6 py-2 bg-red-500/10 border-t border-red-500/20",children:e.jsx("p",{className:"text-red-400 text-xs font-bold",children:h})}),e.jsxs("div",{className:"flex-shrink-0 p-6 border-t border-[#1F2937] flex gap-3",children:[e.jsx("button",{onClick:c,className:"flex-1 py-3 rounded-xl border border-[#1E293B] text-[#6a6a6f] font-semibold hover:bg-[#1F2937]",children:"Cancelar"}),e.jsx("button",{onClick:b,disabled:m,className:"flex-1 py-3 rounded-xl bg-[#10B981] text-black font-semibold hover:bg-[#059669] disabled:opacity-50",children:m?"Salvando...":"Salvar"})]})]})})]})}const v=20;function ne(){const{usuario:t}=q(),{alertModal:u,showAlert:c}=G(),[x,m]=i.useState([]),[h,j]=i.useState([]),[n,o]=i.useState(!0),[b,a]=i.useState(""),[_,k]=i.useState(""),[d,N]=i.useState(1),[I,C]=i.useState(null),[A,S]=i.useState(!1),[L,B]=i.useState(!1),p=i.useRef(null),O=i.useCallback(s=>{k(s),p.current&&clearTimeout(p.current),p.current=setTimeout(()=>a(s),300)},[]),E=async()=>{if(!t?.tenant_id)return;o(!0);const{data:s,error:l}=await w.from("marcas").select("*").eq("tenant_id",t.tenant_id).order("created_at",{ascending:!1});!l&&s?m(s):l&&c({type:"error",title:"Erro",message:"Erro ao buscar marcas: "+l.message}),o(!1)},P=async()=>{if(!t?.tenant_id)return;const{data:s,error:l}=await w.from("segmentos").select("id, nome, emoji").eq("tenant_id",t.tenant_id).order("nome");!l&&s&&j(s)};i.useEffect(()=>{E(),P()},[t]),i.useEffect(()=>()=>{p.current&&clearTimeout(p.current)},[]),i.useEffect(()=>{N(1)},[b]);const g=x.filter(s=>s.nome?.toLowerCase().includes(b.toLowerCase())),f=Math.ceil(g.length/v),T=g.slice((d-1)*v,d*v),z=(d-1)*v+1,R=Math.min(d*v,g.length),F=(s=null)=>{C(s),S(!0)},M=()=>{S(!1),C(null),B(!1)},$=async s=>{B(!0);try{const l={tenant_id:t.tenant_id,nome:s.nome,emoji:s.emoji,id_segmento:s.segmento_id||null,invest_min:s.investimento_minimo||0,invest_max:s.investimento_maximo||0,ativo:!0};if(s.id){const{error:r}=await w.from("marcas").update(l).eq("id",s.id);if(r)throw r}else{const{error:r}=await w.from("marcas").insert(l);if(r)throw r}await E(),M()}catch(l){console.error("Erro ao salvar marca:",l),c({type:"error",title:"Erro ao salvar",message:l.message})}finally{B(!1)}};return n?e.jsx(H,{fullScreen:!1}):e.jsxs("div",{className:"text-white pb-32",children:[e.jsx("div",{className:"px-4 lg:px-10 pt-6 lg:pt-10 mb-6 lg:mb-8",children:e.jsxs(y.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs("h1",{className:"text-2xl lg:text-4xl font-light text-white mb-2",children:["GestÃ£o de ",e.jsx("span",{className:"text-[#10B981] font-bold",children:"Marcas"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 h-0.5 bg-[#10B981] rounded-full"}),e.jsxs("p",{className:"text-[8px] lg:text-[9px] text-gray-600 font-black uppercase tracking-[0.3em]",children:[x.length," ",x.length===1?"marca cadastrada":"marcas cadastradas"]})]})]})}),e.jsx("div",{className:"px-4 lg:px-10 mb-8",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"ðŸ” Buscar marca...",value:_,onChange:s=>O(s.target.value),className:`
              w-full
              bg-[#0F172A]
              border border-white/5
              rounded-2xl
              px-5 py-4
              lg:px-6 lg:py-4
              text-sm lg:text-base
              text-white
              placeholder:text-gray-600
              focus:outline-none
              focus:border-[#10B981]/50
              focus:ring-2
              focus:ring-[#10B981]/20
              transition-all
            `}),_&&e.jsx("button",{onClick:()=>{k(""),a("")},className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors",children:"âœ•"})]})}),e.jsx("div",{className:"px-4 lg:px-10",children:g.length===0?e.jsxs(y.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center py-20",children:[e.jsx("div",{className:"text-6xl mb-4 opacity-30",children:"ðŸ¢"}),e.jsx("p",{className:"text-xl text-gray-400 mb-2",children:b?"Nenhuma marca encontrada":"Nenhuma marca cadastrada"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:b?"Tente ajustar sua busca":"Comece criando sua primeira marca!"}),_&&e.jsx("button",{onClick:()=>{k(""),a("")},className:"px-6 py-3 bg-[#10B981] text-black font-bold rounded-xl hover:bg-[#059669] transition-all",children:"Limpar Busca"})]}):e.jsxs("div",{className:"bg-[#0F172A] border border-white/5 rounded-3xl overflow-hidden",children:[e.jsx("div",{className:"p-4 lg:p-6",children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 lg:gap-6",children:T.map((s,l)=>e.jsx(V,{marca:s,index:l,onClick:()=>F(s)},s.id))})}),e.jsx("div",{className:"px-4 py-4 border-t border-white/5 bg-[#0F172A] rounded-b-3xl",children:e.jsxs("div",{className:"flex flex-col lg:flex-row items-center justify-between gap-4",children:[e.jsxs("p",{className:"text-xs text-gray-600",children:["Exibindo ",e.jsx("span",{className:"text-white font-bold",children:z})," a"," ",e.jsx("span",{className:"text-white font-bold",children:R})," de"," ",e.jsx("span",{className:"text-white font-bold",children:g.length})," itens"]}),f>1&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>N(s=>Math.max(1,s-1)),disabled:d===1,className:"px-4 py-2 rounded-xl bg-white/5 border border-white/10 text-white text-xs font-bold hover:bg-white/10 transition-all disabled:opacity-30 disabled:cursor-not-allowed",children:"â† Anterior"}),e.jsx("div",{className:"flex items-center gap-1",children:[...Array(f)].map((s,l)=>{const r=l+1;return r===1||r===f||r>=d-1&&r<=d+1?e.jsx("button",{onClick:()=>N(r),className:`
                                w-8 h-8 rounded-lg text-xs font-bold transition-all
                                ${d===r?"bg-[#10B981] text-black":"bg-white/5 text-gray-400 hover:bg-white/10"}
                              `,children:r},r):r===d-2||r===d+2?e.jsx("span",{className:"text-gray-600",children:"..."},r):null})}),e.jsx("button",{onClick:()=>N(s=>Math.min(f,s+1)),disabled:d===f,className:"px-4 py-2 rounded-xl bg-white/5 border border-white/10 text-white text-xs font-bold hover:bg-white/10 transition-all disabled:opacity-30 disabled:cursor-not-allowed",children:"PrÃ³xima â†’"})]}),e.jsx("p",{className:"text-[9px] text-gray-700 font-black uppercase tracking-widest",children:"LeadCapture Pro Â· ZafalÃ£o Tech"})]})})]})}),e.jsx(D,{onClick:()=>F(null)}),A&&e.jsx(W,{marca:I,segmentos:h,onClose:M,onSave:$,isSaving:L}),u]})}export{ne as default};
