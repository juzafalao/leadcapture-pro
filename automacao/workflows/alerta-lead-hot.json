{
  "name": "LeadCapture Pro ‚Äî Alerta Lead HOT",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "lead-hot",
        "responseMode": "onReceived",
        "options": {}
      },
      "id": "webhook-hot",
      "name": "Webhook ‚Äî Lead HOT",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [240, 300],
      "webhookId": "lead-hot-webhook"
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{$json[\"categoria\"]}}",
              "value2": "hot",
              "operation": "equals"
            }
          ]
        }
      },
      "id": "check-hot",
      "name": "√â lead HOT?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [460, 300]
    },
    {
      "parameters": {
        "jsCode": "const lead = $input.first().json;\nconst capital = lead.capital_disponivel\n  ? `R$ ${Number(lead.capital_disponivel).toLocaleString('pt-BR')}`\n  : 'N√£o informado';\n\nconst emoji = lead.categoria === 'hot' ? 'üî•' : lead.categoria === 'warm' ? 'üå§' : '‚ùÑÔ∏è';\n\nreturn [{\n  json: {\n    ...lead,\n    mensagem_alerta: [\n      `${emoji} *LEAD HOT CAPTURADO!*`,\n      ``,\n      `üë§ *Nome:* ${lead.nome}`,\n      `üìß *E-mail:* ${lead.email}`,\n      `üì± *WhatsApp:* ${lead.telefone}`,\n      `üí∞ *Capital:* ${capital}`,\n      `üìç *Local:* ${lead.cidade || '‚Äî'} ${lead.estado ? '‚Äî ' + lead.estado : ''}`,\n      `üè¢ *Marca:* ${lead.marca_nome || '‚Äî'}`,\n      `üìä *Score:* ${lead.score}/100`,\n      ``,\n      `_${new Date().toLocaleString('pt-BR', { timeZone: 'America/Sao_Paulo' })}_`\n    ].join('\\n')\n  }\n}];"
      },
      "id": "montar-alerta",
      "name": "Montar alerta",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [680, 220]
    },
    {
      "parameters": {
        "resource": "message",
        "chatId": "={{$env.TELEGRAM_CHAT_ID}}",
        "text": "={{$json[\"mensagem_alerta\"]}}",
        "additionalFields": {
          "parse_mode": "Markdown"
        }
      },
      "id": "telegram-alerta",
      "name": "Telegram ‚Äî Gestor",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [900, 220],
      "credentials": {
        "telegramApi": {
          "id": "telegram-creds",
          "name": "Telegram Bot"
        }
      }
    }
  ],
  "connections": {
    "Webhook ‚Äî Lead HOT": {
      "main": [[ { "node": "√â lead HOT?", "type": "main", "index": 0 } ]]
    },
    "√â lead HOT?": {
      "main": [
        [ { "node": "Montar alerta", "type": "main", "index": 0 } ]
      ]
    },
    "Montar alerta": {
      "main": [[ { "node": "Telegram ‚Äî Gestor", "type": "main", "index": 0 } ]]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "meta": {
    "description": "Alerta imediato no Telegram quando um lead com categoria HOT √© capturado.",
    "version": "1.0.0",
    "author": "Zafal√£o Tech",
    "tags": ["leadcapture", "telegram", "hot", "alerta"]
  }
}
